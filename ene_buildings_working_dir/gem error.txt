

# Works for me in SU 2015-16 on Win 7.
# Fails in 2017 when requiring the Gem (even though installation worked).
# However, after restarting SU require works.
# This initial fal and how it works on restart produces the exact same result
# as some user(s) have reported before.
require "rubygems"
Gem.install "rubyzip"
require "zip"
Zip


# Works in SU2015-17
require "rubygems"
gem_spec = Gem.install("rubyzip")[0]
require File.join(gem_spec.gem_dir, gem_spec.require_path, "zip")
Zip


# This line works in Su2017 but not 16 since method is missing. Not tested in Su15.
require File.join(gem_spec.full_require_paths, "zip")


# It's like the dir isn't added to $LOAD_PATH. Is it?
# And now when testing this simplified code moved out of my plugin the error
# can't be reproduced -_- .

# Error message when error occurs in extension:
Error: #<LoadError: cannot load such file -- zip>
C:/Program Files/SketchUp/SketchUp 2017/Tools/RubyStdLib/rubygems/core_ext/kernel_require.rb:54:in `require'
C:/Program Files/SketchUp/SketchUp 2017/Tools/RubyStdLib/rubygems/core_ext/kernel_require.rb:54:in `require'
D:/Sketchup Plugins/2015/ene_buildings/gem_installer.rb:194:in `block in gem_installer'
SketchUp:1:in `call'


Can't reproduce error when I want it but it occurs when I don't want it :'( .
However SU2017 doesn't seem to add path to $LOAD_PATH immediately when a gem is installed but once SU is restarted.
Also the installation seem to load the gem immediately.